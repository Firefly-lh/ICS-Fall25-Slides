---
theme: academic
highlighter: shiki
title: 08-ECF II
info: |
  ICS 2025 Fall Slides
  Inspired by Arthals
  Presented by Firefly
presenter: false
titleTemplate: '%s'
class: text-center
drawings:
  persist: false
transition: fade-out
mdc: true
layout: cover
---

# 08-ECF II

信息与计算科学 连昊

---

# 关于阶段测试
- 整体情况 
  - 卷子难度有所上升, 更多侧重课本基础知识的掌握 ~~(越来越像生物了)~~
  - 课程均分71, 中位数74
- 希望大家
  - 考的好的同学继续努力, 考的差的同学也不要灰心 **(only 10pts)**
    - 后续的lab测试和期末考可能更加困难
  - 注重基础, 复习的时候优先围绕课本, 课件, 研讨题和作业题展开复习; 确保基础知识掌握牢固后再对往年题适当拟合
  - 遇到简答题, 在时间允许的情况下尽量多写点内容
  - **注意审题**

---

# 试卷讲评
- 改分原则
  - 计算分数错误/登分错误的, 可以改为正确的分数
  - 和官方答案一致/表述相近但被批改错误的, 可以获得对应题目的分数
  - 和官方答案不一致, 但你觉得正确的, 可以课上/课下找我讨论, 有机会argue得到分数
    - 尤其这次简答题居多, 大家觉得自己写的有道理的可以多多找我反馈, 尽量帮大家多争取点分数

---

# 试卷讲评

Exam

T1. 课本P245: 一个指令集体系结构包括定义各种状态单元, 指令集和它们的编码, 一组编程规范和异常事件处理. 干扰项D.E是由 **应用程序二进制接口(ABI)** 规定的 (from课件和研讨题)
   
T7. 课本P285: 运行时钟的速率是由最慢的阶段的延迟限制的

T8. 本题`M_valE`也给分, 课后可以来找我补分

T11. 课本P401第一段, 课上也有强调过 (SRAM为了保持双稳态需要使用更多的晶体管)

T12. 课本P404中间段, 课上也有强调过

T13. 课本P403 图6-5, 考察对DRAM组织结构的理解

T14. 机械硬盘相对于SSD更不抗震耐摔, 主要原因是因为读写头容易划伤磁盘, 进而造成数据损坏

T15. 重点考察了时空局部性, 注意**数据**和**代码**各自都存在局部性

---

# 试卷讲评

Exam

T18. 课本P439 图6-39, 课上有提到过

T19. 对应课本5.1节内容, 回课的同学有重点讲过. 第(1)小问采分点为**可能改变全局变量的值**和**受全局变量影响, 相同参数多次调用可能返回不同值**, 写**副作用**得1分; 第(2)小问的采分点为**不同的内存引用可能指向相同的内存地址**.

T20. 答案有误, 应为`DEG`. A,B引入的库在预处理器(cpp)中直接被替换为原本的内容, 链接器不会看到; H为非静态局部变量, 存放在栈上, 不由链接器处理.

T21. 简答题尽量学会**拆解问题**(题目问了哪些问题), 针对问题进行**分点回答**.

---

# 重点知识纲要
- 信号: 一条小信息, 由内核或进程发送给某一进程, 通知该进程发生了某一类型的事件
  - 重点掌握常见信号(可以参考Arthals的slides), 尤其关注`SIGSTOP`和`SIGKILL`信号既不能被捕获, 也不能被忽略
- 信号术语
  - 信号的发送: 内核修改进程上下文中的某个状态
    - 发送者: 内核(直接修改); 进程(调用`kill`函数), **一个进程可以给自己发送信号**
  - 信号接收: **前台进程**对信号的发送做出反应
    - 可选的操作: 忽略信号; 终止进程; 通过信号处理程序捕获信号
  - 待处理信号: 在后台的进程无法处理信号, 内核通过独立的`pending`位向量, 为每个进程维护一个待处理信号的集合
    - 由于位向量在单个位上只能为0/1, **进程只能知道自己是否收到过信号, 不知道自己收到过多少次信号**, 多余的信号会被简单丢弃
  - 阻塞信号: 进程通过独立的`blocked`位向量来选择性的阻塞接收某类信号, 被阻塞的信号仍能发送但无法被处理

---

# 重点知识纲要

- 信号发送
  - 重点掌握概念:进程组, 作业, 前后台; 熟悉各个信号发送函数的api
    - 重点: 键盘输入`Ctrl+C`会发送`SIGINT`信号给前台进程组中的各个进程, 最终终止前台作业; 类似的, 键盘输入`Ctrl+Z`会发送`SIGTSTOP`信号给前台进程组中的各个进程, 最终停止(挂起)前台作业 (回忆下停止和终止的区别?)
- 信号接收
  - 重点掌握进程接收各类信号的默认行为, `signal`函数的使用, 以及信号处理程序的调用方式
    - 重点1: `SIGSTOP`和`SIGKILL`函数的默认行为无法被`signal`函数修改
    - 重点2: 信号处理程序可以被其它信号处理程序中断 (类似递归调用)
- 信号的阻塞和接触阻塞
  - 隐式信号阻塞: **内核默认阻塞任何当前信号处理程序正在处理信号类型的待处理信号**
  - 显式阻塞: 熟悉`sigprocmask`函数和其辅助函数的调用方式 (你会在shell lab中熟悉它们)

---

# 重点知识纲要

- 实现信号处理函数
  - 安全的信号处理: 重点掌握G0-G5六条原则和它们对应的原因; 熟悉常见的异步信号安全和不安全的函数.
  - 正确的信号处理: 未处理的信号是不排队的(多余即被丢弃), 因此**不可以用信号来对其它进程中发生的事件计数**
- 竞争: 父子进程的并发流导致代码的执行顺序和希望的顺序未必一致
  - 可以通过阻塞信号的方式来解决竞争(**看懂书上P542的图8-39会对你的lab很有帮助**), 注意**子进程会继承父进程的被阻塞信号集合**, 记得在子进程中解除阻塞
- 显式地等待信号: 重点关注`sigsuspend`的调用方式和作用
- 非本地跳转: 将控制从一个函数转移到另一个当前正在执行的函数
  - 一个重要的应用: 允许程序从一个深层嵌套的函数调用中立刻返回(如在发生错误时)
  - 类似的, 熟悉`setjmp`, `longjmp`, `sigsetjmp`, `siglongjmp`的调用方式, 返回值和作用

---
layout: end
---

# Thanks for listening!